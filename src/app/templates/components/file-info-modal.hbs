{{#one-modal
  class=(concat-classes
    "file-info-modal modal-content-overlay without-footer with-close-button"
    modalClass
  )
  open=open
  size="xl"
  backdropClose=true
  keyboard=true
  onHide=(action "close")
  as |modal|
}}
  {{#modal.header class="file-info-modal-header"}}
    <h1>{{headerText}}</h1>
    {{modal-file-subheader files=files}}
    {{#bs-tab
      class="bs-tab-onedata bs-tab-modern file-info-tabbar"
      activeId=activeTab
      customTabs=true
      as |tab|
    }}
      {{#bs-nav
        type="tabs"
        class="nav-tabs-file-info"
        as |nav|
      }}
        {{!-- TODO: VFS-9628 Refactor original file info modal tabs to separate comp. --}}
        {{#if isGeneralTabVisible}}
          {{#nav.item
            active=(eq tab.activeId "general")
          }}
            <a class={{concat-classes
                "nav-link nav-link-general"
                (if (eq tab.activeId "general") "active")
              }}
              role="tab"
              {{action "changeTab" "general"}}
            >
              {{tt this "tabs.general.tabTitle"}}
            </a>
          {{/nav.item}}
        {{/if}}
        {{#if isHardlinksTabVisible}}
          {{#nav.item
            active=(eq tab.activeId "hardlinks")
          }}
            <a class={{concat-classes
                "nav-link nav-link-hardlinks"
                (if (eq tab.activeId "hardlinks") "active")
              }}
              role="tab"
              {{action "changeTab" "hardlinks"}}
            >
              {{tt this "tabs.hardlinks.tabTitle" hardlinksCount=(if
                hardlinksLimitExceeded
                (concat hardlinksLimit "+")
                hardlinksCount
              )}}
            </a>
          {{/nav.item}}
        {{/if}}
        {{#if isSizeTabVisible}}
          {{#nav.item
            active=(eq tab.activeId "size")
          }}
            <a class={{concat-classes
                "nav-link nav-link-size"
                (if (eq tab.activeId "size") "active")
                (if (not isSizeStatsDisabled) "with-status-icon tab-status-success")
              }}
              role="tab"
              {{action "changeTab" "size"}}
            >
              {{tt this "tabs.size.tabTitle"}}
              {{#if (not isSizeStatsDisabled)}}
                {{one-icon class="tab-status-icon" icon="checkbox-filled"}}
              {{/if}}
            </a>
          {{/nav.item}}
        {{/if}}
        {{#if isApiSamplesTabVisible}}
          {{#nav.item
            active=(eq tab.activeId "apiSamples")
          }}
            <a class={{concat-classes
                "nav-link nav-link-apiSamples"
                (if (eq tab.activeId "apiSamples") "active")
              }}
              role="tab"
              {{action "changeTab" "apiSamples"}}
            >
              {{one-icon class="tab-icon" icon="rest"}}
              <div class="tab-label-api-samples">
                {{tt this "tabs.apiSamples.tabTitle"}}
              </div>
            </a>
          {{/nav.item}}
        {{/if}}

        {{#each visibleTabsModels as |tabModel|}}
          {{#nav.item
            active=(eq tab.activeId tabModel.tabId)
            as |navItem|
          }}
            <a
              class={{concat-classes
                "nav-link"
                (concat "nav-link-" tabModel.tabId)
                (if (eq tab.activeId tabModel.tabId) "active")
                (if tabModel.statusIcon "with-status-icon")
                tabModel.tabClass
              }}
              role="tab"
              {{action "changeTab" tabModel.tabId}}
            >
                {{!--
                  TODO: VFS-9626
                  make something like navComponent in addition
                  to simple title to implement custom tabs look (eg. indicators)
                --}}
                <span class="tab-text">{{tabModel.title}}</span>
                {{#if tabModel.statusIcon}}
                  {{one-icon class="tab-status-icon" icon=tabModel.statusIcon}}
                {{/if}}
            </a>
          {{/nav.item}}
        {{/each}}
      {{/bs-nav}}
    {{/bs-tab}}
    {{#if activeTabModel.headerComponent}}
      {{component activeTabModel.headerComponent
        class="file-info-header-extension"
        viewModel=activeTabModel.viewModel
      }}
    {{/if}}
  {{/modal.header}}
  {{#modal.body class="file-info-modal-body"}}
    {{#if (eq activeTab "general")}}
      <table
        class="table table-info table-info-large table-info-collapsible table-file-info"
      >
        <tbody>
          <tr class="file-info-row-name">
            <td class="property-name with-input{{if smallContent "-sm"}}">
              {{tt this "name" type=typeTranslation}}
            </td>
            <td class="property-value">
              {{clipboard-line
                value=fileName
                size=(if smallContent "sm")
              }}
            </td>
          </tr>
          <tr class="file-info-row-path">
            <td class="property-name with-input{{if smallContent "-sm"}}">{{tt this "path" type=typeTranslation}}</td>
            <td class="property-value">
              {{#promise-proxy-container
                proxy=filePathProxy
                sizeClass="xs"
                centered=false
                spinnerBlockClass="loading-file-path"
              }}
                {{clipboard-line
                  value=filePathProxy.content
                  size=(if smallContent "sm")
                }}
              {{/promise-proxy-container}}
            </td>
          </tr>
          {{#if (and (eq itemType "file") (not previewMode))}}
            <tr class="file-info-row-storage-location">
              <td class="property-name with-input{{if smallContent "-sm"}}">
                {{tt this "storageLocations"}}
              </td>
              <td class="property-value">
                {{#promise-proxy-container
                  proxy=storageLocationRequiredDataProxy
                  sizeClass="xs"
                  centered=false
                  spinnerBlockClass="loading-file-path"
                }}
                  {{#if currentProviderLocationsProxy}}
                    {{file-browser/storage-location-per-provider-table
                      spaceId=spaceId
                      locations=currentProviderLocationsProxy.content
                    }}
                  {{/if}}
                  {{#if (and 
                    storageLocationsPerProviderProxy 
                    (gt storageLocationsPerProviderLength 1)
                  )}}
                    {{#if areStorageLocationsExpanded}}
                      {{#each-in storageLocationsPerProviderProxy as |providerId locations|}}
                        {{#if (not-eq providerId currentProviderId)}}
                          {{file-browser/storage-location-per-provider-table
                            spaceId=spaceId
                            locations=locations
                          }}
                        {{/if}}
                      {{/each-in}}
                    {{else}}
                      <div class="storage-locations-expand">
                        <a
                          class="toggle-expand"
                          onClick={{action "toggleStorageLocations"}}
                        >
                          {{tt this "showMore"}}
                        </a>
                      </div>
                    {{/if}}
                  {{/if}}
                {{/promise-proxy-container}}
              </td>
            </tr>
          {{/if}}
          {{#if (eq itemType "symlink")}}
            <tr class="file-info-row-target-path">
              <td class="property-name with-input{{if smallContent "-sm"}}">{{tt this "symlinkTargetPath"}}</td>
              <td class="property-value">
                {{clipboard-line
                  value=symlinkTargetPath
                  size=(if smallContent "sm")
                }}
              </td>
            </tr>
          {{/if}}
          {{#if fileGuiUrl}}
            <tr class="file-info-row-gui-url">
              <td class="property-name with-input{{if smallContent "-sm"}}">
                {{tt this "guiUrl" type=typeTranslation}}
              </td>
              <td class="property-value">
                {{clipboard-line
                  value=fileGuiUrl
                  size=(if smallContent "sm")
                }}
              </td>
            </tr>
          {{/if}}
          <tr id={{cdmiRowId}} class="file-info-row-cdmi-object-id">
            <td class="property-name with-input">
              {{tt this "cdmiObjectId"}}
            </td>
            <td class="property-value">
              <div class="input-group-clipboard-textarea">
                {{clipboard-line
                  value=cdmiObjectId
                  type="textarea"
                  textareaRows="3"
                  size=(if smallContent "sm")
                  class="monospace-font compact"
                }}
              </div>
            </td>
          </tr>
          {{#if space.entityId}}
            <tr class="file-info-row-space-id">
              <td class="property-name with-input{{if smallContent "-sm"}}">{{tt this "spaceId"}}</td>
              <td class="property-value">
                {{clipboard-line
                  value=space.entityId
                  class="monospace-font"
                  size=(if smallContent "sm")
                }}
              </td>
            </tr>
          {{/if}}
          {{#if (eq itemType "file")}}
            <tr class="file-info-row-size">
              <td class="property-name">{{tt this "size"}}</td>
              <td class="property-value">
                {{#truncated-string}}
                  <span class="file-info-size">{{bytes-to-string fileSize}}</span>
                  <span class="file-info-detail-size">({{fileSize}} B)</span>
                {{/truncated-string}}
              </td>
            </tr>
          {{/if}}
          <tr class="file-info-row-modification-time">
            <td class="property-name">{{tt this "modificationTime"}}</td>
            <td class="property-value">
              {{#truncated-string}}
                {{date-format modificationTime format="dateWithMinutes" blank="—"}}
              {{/truncated-string}}
            </td>
          </tr>
          <tr class="file-info-row-owner">
            <td class="property-name">{{tt this "owner"}}</td>
            <td class="property-value">
              {{#promise-proxy-container
                proxy=ownerFullNameProxy
                sizeClass="xs"
                centered=false
                spinnerBlockClass="loading-owner-full-name"
              }}
                {{#truncated-string}}
                  {{or ownerFullNameProxy.content "—"}}
                {{/truncated-string}}
              {{/promise-proxy-container}}
            </td>
          </tr>
        </tbody>
      </table>
    {{else if (eq activeTab "hardlinks")}}
      {{#promise-proxy-container tagName="div" class="loadable-row" proxy=fileHardlinksProxy}}
        {{#if (and hardlinksLimitExceeded fileHardlinks.hardlinks.length)}}
          <p class="shows-first-n-hardlinks text-center">
            <em>{{tt this "tabs.hardlinks.showingOnlyNFirst" limit=hardlinksLimit}}</em>
          </p>
        {{/if}}
        <ul class="file-hardlinks-list">
          {{#each fileHardlinks.hardlinks as |fileHardlink|}}
            {{file-info-modal/hardlink-entry
              class="file-hardlink"
              file=fileHardlink.file
              fileUrl=fileHardlink.fileUrl
              path=fileHardlink.path
              closeModal=modal.close
            }}
          {{else}}
            <li class="file-hardlink extra-hardlink-description">
              <em>{{tt this "tabs.hardlinks.noAccessToAll"
                fileType=(tt this (concat "fileType." itemType))
              }}</em>
              {{#if hardlinksFetchError}}
                {{one-label-tip title=hardlinksFetchError}}
              {{/if}}
            </li>
          {{/each}}
          {{#if (and
            (gt fileHardlinks.hardlinks.length 0)
            (lt fileHardlinks.hardlinks.length fileHardlinks.hardlinksCount)
          )}}
            <li class="file-hardlink extra-hardlink-description">
              <em>{{tt this "tabs.hardlinks.andNMoreYouHaveNoAccess"
                count=(sub fileHardlinks.hardlinksCount fileHardlinks.hardlinks.length)
              }}</em>
              {{#if hardlinksFetchError}}
                {{one-label-tip title=hardlinksFetchError}}
              {{/if}}
            </li>
          {{/if}}
        </ul>
      {{/promise-proxy-container}}
    {{else if (eq activeTab "size")}}
      {{#if isSizeStatsDisabled}}
        {{file-browser/fb-no-dir-statistics
          getProvidersUrl=(action "getProvidersUrl")
        }}
      {{else}}
        {{file-browser/file-entry-charts
          space=space
          file=file
          dirStatsServiceState=dirStatsServiceState
        }}
      {{/if}}
    {{else if (eq activeTab "apiSamples")}}
      {{#promise-proxy-container
        proxy=apiSamplesProxy
        sizeClass="sm"
        centered=false
        spinnerBlockClass="loading-api-command absolute-middle-centered"
      }}
        {{api-samples
          apiSamples=apiSamples
        }}
      {{/promise-proxy-container}}
    {{else}}
      {{component activeTabModel.bodyComponent viewModel=activeTabModel.viewModel}}
    {{/if}}
  {{/modal.body}}
  {{#if isFooterShown}}
    {{#modal.footer}}
      {{component activeTabModel.footerComponent viewModel=activeTabModel.viewModel}}
    {{/modal.footer}}
  {{/if}}
{{/one-modal}}
