<div class="col-xs-12 col-md-8 col-centered">
  <div class="metadata-header-section">
    <h1 class="section-name">{{tt this "metadata"}}</h1>
    <div class="metadata-mode-switch">
      {{#bs-button-group
        value=mode
        class="dublin-core-metadata-mode-btn-group"
        type="radio"
        justified=media.isMobile
        onChange=(action (mut mode)) as |bg|
      }}
        {{#bg.button type="default" class="btn-sm btn-visual-editor" value="visual"}}
          {{one-icon icon="visual-editor"}}
          <span class="text">{{tt this "visual"}}</span>
        {{/bg.button}}
        {{#bg.button type="default" class="btn-sm btn-xml-editor" value="xml"}}
          {{one-icon icon="xml-file"}}
          <span class="text">{{tt this "xml"}}</span>
        {{/bg.button}}
      {{/bs-button-group}}
    </div>
    <p>{{tt this "metadataText"}} {{one-label-tip title=(tt this "metadataTextMore")}}</p>
  </div>
</div>

<div class="row row-open-data-main">
  <div class="col-xs-12 col-md-8 col-centered">
    {{#one-carousel activeSlideId=mode as |carousel|}}
      {{#carousel.slide slideId="visual"}}
        <div class="row row-metadata-form {{if (eq groupedEntries.length 0) "no-entries"}}">
          {{#each groupedEntries as |group|}}
            <div class="metadata-group">
              <div class="metadata-group-header">
                <h2 class="metadata-group-name">
                  {{tt this (concat "dcElementNames." group.type)}}
                </h2>
                <div class="group-add-entry">
                  {{#bs-button
                    type="default"
                    class="btn-sm btn-add-entry"
                    onClick=(action "addEntry" group.type)
                  }}
                    {{one-icon class="add-icon" icon="add-filled"}}
                    <span class="text">
                      {{tt this "add"}}
                      {{lowercase (tt this (concat "dcElementNames." group.type))}}
                    </span>
                  {{/bs-button}}
                </div>
              </div>
              {{#each (range 0 group.values.length) as |index|}}
                <div class="entry-value-group">
                  {{#if (eq group.type "description")}}
                    <textarea
                      class="form-control"
                      data-dc-element-type={{group.type}}
                      rows="4"
                      value={{get group.values index}}
                      placeholder={{tt
                        this
                        "inputPlaceholder"
                        type=(lowercase (tt this (concat "dcElementNames." group.type)))
                      }}
                      oninput={{action "setValue" group.type index}}
                    ></textarea>
                  {{else}}
                    <input
                      class="form-control"
                      type="text"
                      data-dc-element-type={{group.type}}
                      value={{get group.values index}}
                      placeholder={{tt
                        this
                        "inputPlaceholder"
                        type=(lowercase (tt this (concat "dcElementNames." group.type)))
                      }}
                      oninput={{action "setValue" group.type index}}
                    >
                  {{/if}}
                  {{remove-icon onClick=(action "removeEntry" group.type index)}}
                </div>
              {{/each}}
            </div>
          {{/each}}
        </div>
        <div class="row-metadata-group-add">
          <h2>{{tt this "moreElements"}}</h2>
          {{#power-select
            triggerClass="add-metadata-group"
            dropdownClass="add-metadata-group-dropdown"
            options=metadataGroupAddList
            onchange=(action "addMetadataGroup")
            placeholder=(tt this "addMetadataGroup")
            matcher=(action "simpleMatcher")
            as |groupType|}}
            <div class="option-container" data-group-type={{groupType}}>
              {{#truncated-string}}
                <span class="text">
                  {{tt this (concat "dcElementNames." groupType)}}
                </span>
              {{/truncated-string}}
            </div>
          {{/power-select}}
        </div>
      {{/carousel.slide}}
      {{#carousel.slide slideId="xml"}}
        <textarea
          value={{xml}}
          oninput={{action updateXml value="target.value"}}
          placeholder={{tt this "xmlTextareaPlaceholder"}}
          class="no-resize code-textarea open-data-xml-textarea form-control"
        ></textarea>
      {{/carousel.slide}}
    {{/one-carousel}}
    {{#if handleService}}
      <div class="row-publish-info">
        <p>
          {{tt this "publishInfo"
            handleServiceName=handleService.name
            handleServiceId=handleService.entityId
          }}
        </p>
      </div>
    {{/if}}
    <div class="row row-submit">
      <div class="col-xs-12 col-centered col-submit-center">
        {{#bs-button
          class="btn-back"
          type="default"
          onClick=(action "back")
        }}
          {{tt this "back"}}
        {{/bs-button}}
        {{#one-spin-button
          action=(action "submit")
          disabled=submitDisabled
          class="btn btn-primary btn-submit"
        }}
          {{tt this "publish"}}
        {{/one-spin-button}}
      </div>
    </div>
  </div>
</div>